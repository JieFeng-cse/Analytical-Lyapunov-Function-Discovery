<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="Can not find the Lyapunov function? In this work, we propose to use Transformers to find analytical Lyapunov functions, where the training is accomplished by reinforcement learning. Our method scales up to 10D and successfully discovered new Lyapunov functions for challenging power system applications.">
  <meta property="og:title" content="Analytical Lyapunov Function Discovery: An RL-based Generative Approach"/>
  <meta property="og:description" content="Artificial Intelligence, Transformers, RL, Lyapunov Functions."/>
  <meta property="og:url" content="https://jiefeng-cse.github.io/Analytical-Lyapunov-Function-Discovery/"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/deepLyapunov-autoregressive.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Analytical Lyapunov Function Discovery: An RL-based Generative Approach</title>
  <!-- <link rel="icon" type="image/x-icon" href="static/images/favicon.ico"> -->
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Analytical Lyapunov Function Discovery: An RL-based Generative Approach</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://openreview.net/profile?id=~Haohan_Zou1" target="_blank">Haohan Zou</a><sup>*</sup>,</span>
                <span class="author-block">
                  <a href="https://jiefeng-cse.github.io/" target="_blank">Jie Feng</a><sup>*</sup>,</span>
                  <span class="author-block">
                    <a href="https://marcelluszhao.github.io/" target="_blank">Hao Zhao</a>,</span>
                  </span>
                  <span class="author-block">
                    <a href="https://yyshi.eng.ucsd.edu/" target="_blank">Yuanyuan Shi</a>
                  </span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">UC San Diego, EPFL<br>ICML 2025</span>
                    <span class="eql-cntrb"><small><br><sup>*</sup>Indicates Equal Contribution</small></span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://arxiv.org/pdf/2502.02014.pdf" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <!-- Supplementary PDF link
                    <span class="link-block">
                      <a href="static/pdfs/supplementary_material.pdf" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                      </span>
                      <span>Supplementary</span>
                    </a>
                  </span> -->

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/JieFeng-cse/Analytical-Lyapunov-Function-Discovery" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code (Coming soon)</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2502.02014" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser video-->
<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls muted loop height="100%">
        <source src="static/videos/banner_video.mp4"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Aliquam vitae elit ullamcorper tellus egestas pellentesque. Ut lacus tellus, maximus vel lectus at, placerat pretium mi. Maecenas dignissim tincidunt vestibulum. Sed consequat hendrerit nisl ut maximus. 
      </h2>
    </div>
  </div>
</section> -->
<!-- End teaser video -->

<section id="teaser" class="section"> 
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-four-fifths"> 
        <figure class="image" style="margin-bottom: 1.5rem;"> 
          <img src="/Analytical-Lyapunov-Function-Discovery/static/images/deepLyapunov-autoregressive.png" alt="Framework overview" id="framework-teaser-image"> 
        </figure>
        <h2 class="subtitle has-text-centered is-size-6">
          <strong>Framework overview:</strong> The transformer takes embeddings of the dynamical system model as input and generates candidate Lyapunov functions in an autoregressive manner. Hierarchical information is deployed to enhance the model input. For example, when generating the last token x<sub>2</sub>, its parent is +, and its sibling is x<sub>1</sub>. The output is the pre-order traversal of the expression's binary tree. Candidates are verified using a global-optimization-based verification process, with counterexamples added to the training set for reward calculation. The transformer is updated via the risk-seeking policy gradient. The program terminates once a valid candidate expression is found. 
      </div>
    </div>
  </div>
</section>

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Despite advances in learning-based methods, finding valid Lyapunov functions for nonlinear dynamical systems remains challenging. Current neural network approaches face two main issues:  challenges in scalable verification and limited interpretability. To address these, we propose an end-to-end framework using transformers to construct analytical Lyapunov functions (local), which simplifies formal verification, enhances interpretability, and provides valuable insights for control engineers. Our framework consists of a transformer-based trainer that generates candidate Lyapunov functions and a falsifier that verifies candidate expressions and refines the model via risk-seeking policy gradient. Unlike Alfarano et al. (2024), which utilizes pre-training and seeks global Lyapunov functions for low-dimensional systems, our model is trained from scratch via reinforcement learning (RL) and succeeds in finding local Lyapunov functions for high-dimensional and non-polynomial systems. Given the analytical nature of the candidates, we employ efficient optimization methods for falsification during training and formal verification tools for the final verification. We demonstrate the efficiency of our approach on a range of nonlinear dynamical systems with up to ten dimensions and show that it can discover Lyapunov functions not previously identified in the control literature. 
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<section class="section"> 
  <div class="container is-max-desktop">


    <h2 class="title is-3"> 
      Symbolic Representation
    </h2>


    <figure class="image" style="margin-top: 1rem; margin-bottom: 1.5rem;"> 
      <img id="your-figure-image" src="static/images/symbolic_representation.png" alt="Descriptive text for your image">
    </figure>

    <div class="content"> 
      <p>
       Following the expression representation rules of deep symbolic regression frameworks, we represent symbolic transformer models' input and output as sequences of symbolic tokens. 
       Each mathematical expression can be converted into a symbolic expression tree, a binary tree where internal nodes are symbolic operators and terminal nodes (leaves in the tree) are variables or constants. 
       Furthermore, each symbolic expression tree can be represented as a sequence of node values, by its pre-order traversal (i.e. first visiting the parent, then traversing the left child and right child). 
       In this way, each expression obtains a pre-order traversal representation, which can uniquely reconstruct the original expression.
      </p>
      

    </div>

  </div>
</section>

<!-- Lyapunov Function Verification (image‑based) -->
<section id="lyapunov-verification" class="section">
  <div class="container is-max-desktop">

    <h2 class="title is-3">Lyapunov Function Verification</h2>

    <!-- 2‑column layout: text on the left, figure on the right -->
    <div class="columns is-vcentered is-multiline">

      <!-- LEFT COLUMN ---------------------------------------------------- -->
      <div class="column is-half">
        <h3 class="title is-5" style="margin-bottom:0.75rem;">Global‑Optimization‑Based Verification</h3>
        <ul style="margin-left:1.25rem;">
          <li>Find the greatest violation.</li>
          <li><strong>Verifier:</strong> Simplicial Homology Global Optimization (SHGO).</li>
        </ul>

        <!-- Proposition box -->
        <div class="proposition-box">
          <p style="margin-bottom:0;"><strong>Proposition&nbsp;<span style="font-weight:500;">(Convergence Guarantees of&nbsp;SHGO)</span></strong> &nbsp;<em>(Informal)</em> &mdash; For a given continuous objective function&nbsp;<em>f</em> that is <em>adequately&nbsp;sampled</em>, the global minimizer can be found.</p>
        </div>

        <!-- Red highlighted explanatory text -->
        <p class="highlight-red" style="margin-top:1.25rem;">
          What does <em>'adequately&nbsp;sampled'</em> mean?
        </p>
        <p style="margin-bottom:1.5rem;">
          The sub-convex domains cover the whole space of interest. The required number can be unbounded.
        </p>

      </div>

      <!-- RIGHT COLUMN --------------------------------------------------- -->
      <div class="column is-half">
        <figure class="image" style="width:100%;max-width:420px;margin:0 auto;">
          <!-- Replace the src path with the actual location of your PNG image -->
          <img src="static/images/shgo_plot.png" alt="Contour landscape and sub‑convex domain used by SHGO">
        </figure>
      </div>

    </div> <!-- /columns -->

    <div class="content"> 
      <p>
        We verify the Lyapunov candidates using the SHGO global optimizer. By locating the worst-case violation, we obtain higher-quality Lyapunov functions.
      </p>
    </div>
  </div>
</section>

<!-- -------------- Inline style for the proposition box & red text -->
<style>
  /* Common figure caption */
  .figure-caption{font-size:0.9rem;text-align:center;margin-top:1rem;}

  /* Proposition styling */
  .proposition-box{
    border:4px solid #0d274d;
    border-radius:12px;
    padding:1rem 1.25rem;
    background:#f8f8f8;
    font-family:"Times New Roman",serif;
    line-height:1.35;
  }
  .highlight-red{color:#c00000;font-weight:600;}

  /* Token boxes (green & blue) */
  .token-box{
    display:inline-block;
    padding:0.5rem 0.75rem;
    border-radius:8px;
    font-family:"Menlo",monospace;
    font-size:0.9rem;
  }
  .green-box{background:#d8ead3;border:1px solid #7bb36a;}
  .blue-box{background:#e8effb;border:1px solid #4a7eb4;}

  /* Responsive arrow sizing fix */
  @media (max-width: 768px){
    .fa-arrow-right{transform:rotate(90deg);} /* vertical alignment on mobile */
  }
</style>

<!-- -------------- MathJax for LaTeX rendering ---------------------------- -->
<script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


<section class="section two-figures-side-by-side">
  <div class="container is-max-desktop">

    <h2 class="title is-3"> 
     Risk-seeking Policy Gradient
    </h2>

    <div class="columns is-vcentered is-multiline"> 
      
      <div class="column is-half"> 
        <figure class="image">
          <img id="side-figure-1" src="static/images/best_reward_comp.png" alt="Description for Figure A">
        </figure>
        <p class="has-text-centered" style="margin-top: 0.75rem; font-size: 0.9rem;">
          Trajectories of the best rewards.
        </p>
      </div>

      <div class="column is-half"> 
        <figure class="image">
          <img id="side-figure-2" src="static/images/top_reward_comp.png" alt="Description for Figure B">
        </figure>
        <p class="has-text-centered" style="margin-top: 0.75rem; font-size: 0.9rem;">
          Trajectories of the 90% quantile of reward distibutions.
        </p>
      </div>

    </div>
    <div class="content"> 
      <p>
       Given the performance measure for the generated candidates is non-differentiable with respect to the transformer parameters, we emplocy risk-seeking policy gradient to update the transformers end-to-end. 
       The rationale of this selection is that the final performance depends on finding at least one valid Lyapunov function, rather than optimizing for average performance.
       Specifically, the risk-seeking policy gradient only focuses on maximizing best-case performace, i.e., the objective function aims to optimize only the rewards of high-quality candidates from the top 1-alpha quantile.
      </p>

      <p>
        In these two figures, we show that when alpha=0.1, it achieves the best performance with fast and steady convergence, compared with the median-based threshold and the vanilla policy gradient.
      </p>
      

    </div>
  </div>
</section>

<!-- Automated Expert Guidance ---------------------------------------------- -->
<section id="expert-guidance" class="section">
  <div class="container is-max-desktop">
    <h2 class="title is-3">Automated Expert Guidance</h2>
    <p class="subtitle is-5" style="margin-bottom:2rem;">
      Integrate GP as automated expert guidance to accelerate training.
    </p>

    <!-- Graphic flow: three columns -->
    <div class="columns is-vcentered is-variable is-8">

      <!-- Candidate Lyapunov functions box -->
      <div class="column has-text-centered">
        <div class="token-box green-box">
          \(\{\tilde{V}_{\phi}^{i} \sim p_{\phi}(V\,|\,f)\}_{i=1}^{Q}\)
        </div>
        <p style="margin-top:0.75rem;font-size:0.9rem;">Candidate Lyapunov functions<br>from transformer</p>
      </div>

      <!-- Arrow -->
      <div class="column is-narrow has-text-centered">
        <span class="icon is-large" style="font-size:2.5rem;">
          <i class="fas fa-arrow-right"></i>
        </span>
      </div>

      <!-- GP Logo -->
      <div class="column has-text-centered">
        <figure class="image" style="max-width:180px;margin:0 auto;">
          <!-- Provide the correct path to the DEAP/GP logo -->
          <img src="static/images/GP_logo.png" alt="DEAP: GP package logo">
        </figure>
        <p style="margin-top:0.75rem;font-size:0.9rem;">DEAP: GP package</p>
      </div>

    </div> <!-- /columns -->

    <!-- Expert guidance loss formula -->
    <div class="columns is-centered" style="margin-top:1.75rem;">
      <div class="column is-narrow has-text-centered">
        <div class="token-box blue-box" style="overflow-x:auto; white-space: nowrap;">
          \(
            \mathcal{L}_{\text{ce}} = \frac{-1}{G}\sum_{i=1}^{G}\frac{1}{k_i}\,R(\tilde{V}_{gp}^{i})\sum_{j=1}^{k_i}\log\Big(p(\tilde{V}_{gp_j}^{i}\,|\,\tilde{V}_{gp_{1:(j-1)}}^{i};\,\phi;f(x))\Big)
          \)
        </div>
        <p style="margin-top:0.75rem;font-size:0.9rem;">Expert guidance loss</p>
      </div>
    </div>

    <div class="content" style="margin-top:1.5rem;">
      <p>
        Genetic programming (GP) is a helpful evolutionary algorithm that can improve the quality of candidate expressions via evolutionary operations (e.g.&nbsp;permute, mutate).
        We use GP to refine generation quality and introduce an <em>expert guidance loss</em>&nbsp;&mdash; a supervision term that raises the probability of better candidates found by GP.
        Empirically, it significantly accelerates training. <strong>Note&nbsp;:</strong> GP alone is usually insufficient to find valid Lyapunov functions from scratch, especially in high‑dimensional systems.
      </p>
    </div>
  </div>
</section>

<section class="section"> 
  <div class="container is-max-desktop">


    <h2 class="title is-3"> 
      Results
    </h2>


    <figure class="image" style="margin-top: 1rem; margin-bottom: 1.5rem;"> 
      <img id="your-figure-image" src="static/images/results.png" alt="Descriptive text for your image">
    </figure>

    <div class="content"> 
      <p>
       Benifits of analytical Lyapunov functions: (1) Interpretability. The Lyapunov functions of the power system dynamics and the pendulum dynamics align with their energy function. (2) Fast verification. (3) Possibility to extend to global stability.
      </p>
      <p>
        For the 4-D lossy power system, it found a local Lyapunov function. This dynamics do not have a known Lyapunov function in the literature.
      </p>
      

    </div>

  </div>
</section>



<!-- Image carousel -->
<!-- <section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item">
          <img src="/Analytical-Lyapunov-Function-Discovery/static/images/deepLyapunov-autoregressive.png" alt="Framework overview">
          <h2 class="subtitle has-text-centered">
            <strong>Framework overview:</strong> The transformer takes embeddings of the dynamical system model as input and generates candidate Lyapunov functions in an autoregressive manner. The output is the pre-order traversal of the expression’s binary tree. Candidates are verified using a global-optimization-based verification process, with counterexamples added to the training set for reward calculation. The transformer is updated via the risk-seeking policy gradient. The program terminates once a valid candidate expression is found. <strong>Note:</strong> The input symbolic tokens of encoder are the parent and sibling of current generating token if exist. For the last generated x<sub>2</sub>, for example, x<sub>1</sub> is its sibling and + is its parent (refer to the binary symbolic tree in top-right corner for hierarchical relations).
          </h2>
        </div> -->
      <!-- <div class="item">
        
        <img src="static/images/carousel2.jpg" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
          Second image description.
        </h2>
      </div>
      <div class="item">
        
        <img src="static/images/carousel3.jpg" alt="MY ALT TEXT"/>
        <h2 class="subtitle has-text-centered">
         Third image description.
       </h2>
     </div>
     <div class="item">
      
      <img src="static/images/carousel4.jpg" alt="MY ALT TEXT"/>
      <h2 class="subtitle has-text-centered">
        Fourth image description.
      </h2>
    </div> -->
  <!-- </div>
</div>
</div>
</section> -->
<!-- End image carousel -->




<!-- Youtube video -->
<!-- <section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">

      <h2 class="title is-3">Video Presentation</h2>
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          
          <div class="publication-video">

            <iframe src="https://www.youtube.com/embed/JkaxUblCGz0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
</section> -->
<!-- End youtube video -->


<!-- Video carousel -->
<!-- <section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3">Another Carousel</h2>
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-video1">
          <video poster="" id="video1" autoplay controls muted loop height="100%">

            <source src="static/videos/carousel1.mp4"
            type="video/mp4">
          </video>
        </div>
        <div class="item item-video2">
          <video poster="" id="video2" autoplay controls muted loop height="100%">

            <source src="static/videos/carousel2.mp4"
            type="video/mp4">
          </video>
        </div>
        <div class="item item-video3">
          <video poster="" id="video3" autoplay controls muted loop height="100%">\

            <source src="static/videos/carousel3.mp4"
            type="video/mp4">
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->
<!-- End video carousel -->






<!-- Paper poster -->
<!-- <section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">Poster</h2>

      <iframe  src="static/pdfs/sample.pdf" width="100%" height="550">
          </iframe>
        
      </div>
    </div>
  </section> -->
<!--End paper poster -->


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>
        @misc{zou2025analyticallyapunovfunctiondiscovery,
          title={Analytical Lyapunov Function Discovery: An RL-based Generative Approach}, 
          author={Haohan Zou and Jie Feng and Hao Zhao and Yuanyuan Shi},
          year={2025},
          eprint={2502.02014},
          archivePrefix={arXiv},
          primaryClass={cs.LG},
          url={https://arxiv.org/abs/2502.02014}, 
    }
      </code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
